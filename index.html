<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HDD Space Monitor Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <!-- Chosen Palette: Tech Monitor Palette -->
    <!-- Application Structure Plan: A single-page dashboard layout is chosen for optimal user experience in a monitoring context. The structure includes: 1) A fixed header for global controls (Refresh, Toggle Offline) and key status indicators (DB Connection, Server Counts), providing immediate access and at-a-glance info. 2) A two-column main content area. The left column serves as a dedicated control panel for filtering by "Family" and viewing a summary chart, centralizing user interactions. The right column is the primary display area for server "cards", grouped by family. This separation of controls and data display is a proven, user-friendly pattern that prevents UI clutter and allows users to efficiently focus on relevant information. The user flow is intuitive: land, get an overview, filter to focus, and refresh as needed. -->
    <!-- Visualization & Content Choices: 
        - Server List: Report Info -> Server disk usage data. Goal -> Inform & Compare. Viz -> HTML/CSS Cards with progress bars. Interaction -> Filtering. Justification -> Cards are excellent for scanning individual item statuses, and progress bars provide instant visual cues for usage levels. Library -> Tailwind CSS, Vanilla JS.
        - Summary Stats: Report Info -> Aggregate server counts (Total, Online, Critical). Goal -> Inform. Viz -> KPI Boxes (large text). Interaction -> Dynamic updates on filter/refresh. Justification -> Standard dashboard element for clear, high-level metrics. Library -> Vanilla JS.
        - Usage Distribution: Report Info -> Percentage usage for all servers. Goal -> Organize & Compare. Viz -> Donut Chart (Chart.js). Interaction -> Updates with filters, tooltips on hover. Justification -> Provides a powerful visual summary of overall system health, showing the proportion of servers in different states (Normal, Warning, Critical) more effectively than text alone. Library -> Chart.js on Canvas.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .fa-spin-slow {
            animation: fa-spin 2s linear infinite;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 350px;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
        }
        .progress-bar-fill {
            transition: width 0.5s ease-in-out;
        }
        .card {
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <div id="app" class="flex flex-col min-h-screen">
        <header class="bg-white/80 backdrop-blur-lg border-b border-slate-200 sticky top-0 z-10">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex items-center justify-between h-16">
                    <div class="flex items-center space-x-3">
                        <i class="fas fa-hdd text-2xl text-sky-600"></i>
                        <h1 class="text-xl font-bold text-slate-800">HDD Space Monitor</h1>
                    </div>
                    <div class="flex items-center space-x-4">
                        <div id="db-status" class="flex items-center space-x-2 text-sm font-medium text-slate-500">
                            <div class="w-3 h-3 rounded-full bg-gray-400 animate-pulse"></div>
                            <span>DB Connecting...</span>
                        </div>
                        <button id="refresh-button" title="Refresh Data" class="flex items-center justify-center w-10 h-10 bg-slate-100 hover:bg-sky-100 text-slate-600 hover:text-sky-600 rounded-full transition-colors">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <main class="flex-grow max-w-7xl w-full mx-auto p-4 sm:p-6 lg:p-8">
            <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
                
                <aside class="lg:col-span-1 space-y-8">
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                        <h2 class="text-lg font-semibold text-slate-800 mb-4">System Overview</h2>
                        <div class="grid grid-cols-3 gap-4 text-center">
                            <div>
                                <p class="text-2xl font-bold text-slate-700" id="total-servers">0</p>
                                <p class="text-xs text-slate-500">Total</p>
                            </div>
                            <div>
                                <p class="text-2xl font-bold text-green-600" id="online-servers">0</p>
                                <p class="text-xs text-slate-500">Online</p>
                            </div>
                            <div>
                                <p class="text-2xl font-bold text-red-600" id="critical-servers">0</p>
                                <p class="text-xs text-slate-500">Critical</p>
                            </div>
                        </div>
                        <div class="mt-6">
                            <div class="chart-container">
                                <canvas id="statusChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                        <div class="flex justify-between items-center mb-4">
                            <h2 class="text-lg font-semibold text-slate-800">Filters</h2>
                            <button id="reset-filters" class="text-xs font-medium text-sky-600 hover:text-sky-800">Reset</button>
                        </div>
                        
                        <div class="space-y-3">
                            <label class="flex items-center justify-between p-3 bg-slate-50 rounded-lg">
                                <span class="font-medium text-sm text-slate-700">Hide Offline Servers</span>
                                <input type="checkbox" id="hide-offline-toggle" class="form-checkbox h-5 w-5 text-sky-600 rounded border-slate-300 focus:ring-sky-500" checked>
                            </label>
                        </div>
                        
                        <div id="family-filters" class="mt-6 space-y-2">
                            <h3 class="text-sm font-semibold text-slate-600 mb-2">Family Groups</h3>
                        </div>
                    </div>
                </aside>

                <div id="server-list" class="lg:col-span-3 space-y-8">
                     <div class="text-center py-16">
                        <i class="fas fa-spinner fa-spin-slow text-4xl text-slate-300"></i>
                        <p class="mt-4 text-slate-500">Loading server data...</p>
                    </div>
                </div>
            </div>
        </main>
        
        <footer class="bg-white border-t border-slate-200 mt-8">
             <div class="max-w-7xl mx-auto py-4 px-4 sm:px-6 lg:px-8 text-center text-sm text-slate-500">
                <p>&copy; 2024 HDD Space Monitoring Dashboard. All rights reserved.</p>
            </div>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const mockServerData = [
                { ip: '192.168.1.10', hostname: 'WEB-SERVER-01', usePercentage: '85%', progress: 85, ubuntuVersion: '22.04 LTS', freeSpace: '37.5 GB', totalSpace: '250 GB', owner: 'DevTeam', family: 'Web Services' },
                { ip: '192.168.1.11', hostname: 'DB-SERVER-01', usePercentage: '92%', progress: 92, ubuntuVersion: '20.04 LTS', freeSpace: '40 GB', totalSpace: '500 GB', owner: 'DBA Team', family: 'Database' },
                { ip: '192.168.1.12', hostname: 'APP-SERVER-01', usePercentage: '65%', progress: 65, ubuntuVersion: '22.04 LTS', freeSpace: '87.5 GB', totalSpace: '250 GB', owner: 'AppDev', family: 'Application' },
                { ip: '192.168.1.13', hostname: 'CACHE-SERVER', usePercentage: '30%', progress: 30, ubuntuVersion: '20.04 LTS', freeSpace: '70 GB', totalSpace: '100 GB', owner: 'Infra', family: 'Infrastructure' },
                { ip: '192.168.1.14', hostname: 'BACKUP-SERVER', error: 'offline', owner: 'Infra', family: 'Infrastructure' },
                { ip: '192.168.1.15', hostname: 'DB-SERVER-02', usePercentage: '78%', progress: 78, ubuntuVersion: '20.04 LTS', freeSpace: '110 GB', totalSpace: '500 GB', owner: 'DBA Team', family: 'Database' },
                { ip: '192.168.1.16', hostname: 'WEB-SERVER-02', usePercentage: '45%', progress: 45, ubuntuVersion: '22.04 LTS', freeSpace: '137.5 GB', totalSpace: '250 GB', owner: 'DevTeam', family: 'Web Services' },
                { ip: '192.168.1.17', hostname: 'TEST-SERVER-01', usePercentage: '99%', progress: 99, ubuntuVersion: '22.04 LTS', freeSpace: '1 GB', totalSpace: '100 GB', owner: 'QA Team', family: 'Testing' },
                { ip: '192.168.1.18', hostname: 'STAGING-SERVER', error: 'offline', owner: 'DevTeam', family: 'Web Services' },
            ];

            let serverData = [];
            let statusChart;

            const state = {
                hideOffline: true,
                selectedFamilies: new Set()
            };

            const elements = {
                serverList: document.getElementById('server-list'),
                familyFilters: document.getElementById('family-filters'),
                hideOfflineToggle: document.getElementById('hide-offline-toggle'),
                totalServers: document.getElementById('total-servers'),
                onlineServers: document.getElementById('online-servers'),
                criticalServers: document.getElementById('critical-servers'),
                refreshButton: document.getElementById('refresh-button'),
                resetFiltersButton: document.getElementById('reset-filters'),
                dbStatus: document.getElementById('db-status'),
            };
            
            const getStatusStyles = (progress) => {
                if (progress > 90) return {
                    cardBorder: 'border-red-500',
                    iconBg: 'bg-red-100',
                    iconText: 'text-red-600',
                    progressBg: 'bg-red-500',
                    statusText: 'Critical'
                };
                if (progress > 70) return {
                    cardBorder: 'border-amber-500',
                    iconBg: 'bg-amber-100',
                    iconText: 'text-amber-600',
                    progressBg: 'bg-amber-500',
                    statusText: 'Warning'
                };
                return {
                    cardBorder: 'border-slate-100',
                    iconBg: 'bg-slate-100',
                    iconText: 'text-slate-600',
                    progressBg: 'bg-sky-500',
                    statusText: 'Normal'
                };
            };

            const renderServerCard = (data) => {
                if (data.error === 'offline') {
                    return `
                        <div class="bg-white p-5 rounded-2xl shadow-sm border border-slate-200 opacity-60">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-4">
                                    <div class="flex-shrink-0 w-12 h-12 rounded-full bg-slate-100 flex items-center justify-center">
                                        <i class="fas fa-power-off text-xl text-slate-400"></i>
                                    </div>
                                    <div>
                                        <p class="font-semibold text-slate-800">${data.hostname || data.ip}</p>
                                        <p class="text-sm text-slate-500">${data.ip}</p>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <p class="font-bold text-slate-500">OFFLINE</p>
                                    <p class="text-xs text-slate-400">By: ${data.owner}</p>
                                </div>
                            </div>
                        </div>
                    `;
                }

                const styles = getStatusStyles(data.progress);
                return `
                    <div class="card bg-white p-5 rounded-2xl shadow-sm border ${styles.cardBorder}">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center space-x-4">
                                <div class="flex-shrink-0 w-12 h-12 rounded-full ${styles.iconBg} flex items-center justify-center">
                                    <i class="fas fa-hdd text-xl ${styles.iconText}"></i>
                                </div>
                                <div>
                                    <p class="font-semibold text-slate-800">${data.hostname || data.ip}</p>
                                    <p class="text-sm text-slate-500">${data.ip}</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="font-bold text-2xl ${styles.iconText}">${data.progress}%</p>
                                <p class="text-xs font-medium text-slate-500">${styles.statusText}</p>
                            </div>
                        </div>
                        <div>
                            <div class="w-full bg-slate-100 rounded-full h-2.5 mb-2">
                                <div class="progress-bar-fill ${styles.progressBg} h-2.5 rounded-full" style="width: ${data.progress}%"></div>
                            </div>
                            <div class="flex justify-between text-xs text-slate-500">
                                <span>${data.usedSpace || (data.totalSpace.replace(' GB','') * data.progress / 100).toFixed(1) + ' GB'} / ${data.totalSpace}</span>
                                <span>Free: ${data.freeSpace}</span>
                            </div>
                        </div>
                        <div class="mt-4 pt-4 border-t border-slate-100 flex items-center justify-between text-xs text-slate-400">
                            <span><i class="fas fa-user-tag mr-1.5"></i>${data.owner}</span>
                            <span><i class="fab fa-ubuntu mr-1.5"></i>${data.ubuntuVersion}</span>
                        </div>
                    </div>
                `;
            };

            const render = () => {
                const filteredData = serverData.filter(server => {
                    const isOffline = server.error === 'offline';
                    if (state.hideOffline && isOffline) return false;
                    
                    const familyMatch = state.selectedFamilies.size === 0 || state.selectedFamilies.has(server.family);
                    return familyMatch;
                });

                const groupedByFamily = filteredData.reduce((acc, server) => {
                    const family = server.family || 'Uncategorized';
                    if (!acc[family]) acc[family] = [];
                    acc[family].push(server);
                    return acc;
                }, {});
                
                const sortedFamilies = Object.keys(groupedByFamily).sort();

                if (sortedFamilies.length === 0) {
                    elements.serverList.innerHTML = `
                        <div class="text-center py-16 bg-white rounded-2xl shadow-sm border border-slate-100">
                            <i class="fas fa-info-circle text-4xl text-slate-300"></i>
                            <p class="mt-4 text-slate-500">No servers found matching the selected filters.</p>
                        </div>
                    `;
                } else {
                    elements.serverList.innerHTML = sortedFamilies.map(family => `
                        <div>
                            <div class="flex items-center space-x-3 mb-4">
                                <i class="fas fa-layer-group text-sky-600"></i>
                                <h2 class="text-xl font-bold text-slate-700">${family}</h2>
                                <span class="text-sm font-medium bg-slate-100 text-slate-500 px-2.5 py-0.5 rounded-full">${groupedByFamily[family].length}</span>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                ${groupedByFamily[family].map(renderServerCard).join('')}
                            </div>
                        </div>
                    `).join('');
                }
                updateSummary(filteredData);
            };

            const updateSummary = (data) => {
                const online = data.filter(s => s.error !== 'offline');
                const critical = online.filter(s => s.progress > 90);
                const warning = online.filter(s => s.progress > 70 && s.progress <= 90);
                const normal = online.filter(s => s.progress <= 70);

                elements.totalServers.textContent = data.length;
                elements.onlineServers.textContent = online.length;
                elements.criticalServers.textContent = critical.length;

                const chartData = {
                    labels: ['Normal', 'Warning', 'Critical'],
                    datasets: [{
                        label: 'Server Status',
                        data: [normal.length, warning.length, critical.length],
                        backgroundColor: [
                            'rgb(14 165 233)', // sky-500
                            'rgb(245 158 11)', // amber-500
                            'rgb(239 68 68)'   // red-500
                        ],
                        borderColor: 'rgb(255, 255, 255)',
                        borderWidth: 4,
                        hoverOffset: 8
                    }]
                };

                if (statusChart) {
                    statusChart.data = chartData;
                    statusChart.update();
                } else {
                    const ctx = document.getElementById('statusChart').getContext('2d');
                    statusChart = new Chart(ctx, {
                        type: 'doughnut',
                        data: chartData,
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            cutout: '70%',
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: {
                                        padding: 20,
                                        boxWidth: 12,
                                        font: {
                                            size: 12
                                        }
                                    }
                                },
                                tooltip: {
                                    enabled: true,
                                    callbacks: {
                                        label: function(context) {
                                            return `${context.label}: ${context.raw} Servers`;
                                        }
                                    }
                                }
                            }
                        }
                    });
                }
            };

            const setupFilters = () => {
                const families = [...new Set(serverData.map(s => s.family || 'Uncategorized'))].sort();
                elements.familyFilters.innerHTML += families.map(family => `
                    <label class="flex items-center space-x-3 cursor-pointer p-2 rounded-md hover:bg-slate-50">
                        <input type="checkbox" data-family="${family}" class="form-checkbox family-checkbox h-4 w-4 text-sky-600 rounded border-slate-300 focus:ring-sky-500">
                        <span class="text-sm text-slate-700">${family}</span>
                    </label>
                `).join('');

                document.querySelectorAll('.family-checkbox').forEach(checkbox => {
                    checkbox.addEventListener('change', (e) => {
                        const family = e.target.dataset.family;
                        if (e.target.checked) {
                            state.selectedFamilies.add(family);
                        } else {
                            state.selectedFamilies.delete(family);
                        }
                        render();
                    });
                });
            };

            const fetchData = () => {
                elements.refreshButton.querySelector('i').classList.add('fa-spin-slow');
                elements.serverList.innerHTML = `
                    <div class="text-center py-16">
                        <i class="fas fa-spinner fa-spin-slow text-4xl text-slate-300"></i>
                        <p class="mt-4 text-slate-500">Loading server data...</p>
                    </div>
                `;
                
                setTimeout(() => {https://github.com/Natdel1/HDD_monitor/blob/main/index.html
                    serverData = mockServerData.sort((a, b) => (a.hostname || a.ip).localeCompare(b.hostname || b.ip));
                    elements.refreshButton.querySelector('i').classList.remove('fa-spin-slow');
                    
                    if (elements.familyFilters.children.length <= 1) {
                         setupFilters();
                    }
                    render();
                }, 1500);
            };
            
            const testDbConnection = () => {
                elements.dbStatus.innerHTML = `
                    <div class="w-3 h-3 rounded-full bg-amber-400 animate-pulse"></div>
                    <span>DB Testing...</span>
                `;
                setTimeout(() => {
                    elements.dbStatus.innerHTML = `
                        <div class="w-3 h-3 rounded-full bg-green-500"></div>
                        <span class="text-green-700">DB Connected</span>
                    `;
                }, 1200);
            };

            elements.hideOfflineToggle.addEventListener('change', (e) => {
                state.hideOffline = e.target.checked;
                render();
            });

            elements.refreshButton.addEventListener('click', fetchData);
            
            elements.resetFiltersButton.addEventListener('click', () => {
                state.selectedFamilies.clear();
                document.querySelectorAll('.family-checkbox').forEach(cb => cb.checked = false);
                elements.hideOfflineToggle.checked = true;
                state.hideOffline = true;
                render();
            });

            fetchData();
            testDbConnection();
        });
    </script>
</body>
</html>
